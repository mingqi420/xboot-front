{"remainingRequest":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\dove\\project\\xboot\\xboot-front-master\\src\\views\\my-components\\xboot\\file-upload.vue?vue&type=style&index=0&id=fc422f2a&lang=less&scoped=true&","dependencies":[{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\src\\views\\my-components\\xboot\\file-upload.vue","mtime":1600218271000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmZpbGUtdXBsb2FkLXdyYXAgewogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAuZmlsZS11cGxvYWQgewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgbWFyZ2luLXJpZ2h0OiAxMHB4OwogIH0KfQo="},{"version":3,"sources":["file-upload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"file-upload.vue","sourceRoot":"src/views/my-components/xboot","sourcesContent":["<template>\n  <div>\n    <div class=\"file-upload-wrap\">\n      <Upload\n        :action=\"uploadFileUrl\"\n        :headers=\"accessToken\"\n        :on-success=\"handleSuccess\"\n        :on-error=\"handleError\"\n        :format=\"format\"\n        :accept=\"accept\"\n        :max-size=\"maxSize*1024\"\n        :on-format-error=\"handleFormatError\"\n        :on-exceeded-size=\"handleMaxSize\"\n        :before-upload=\"beforeUpload\"\n        :show-upload-list=\"false\"\n        class=\"file-upload\"\n      >\n        <Button\n          :loading=\"loading\"\n          :type=\"type\"\n          :ghost=\"ghost\"\n          :shape=\"shape\"\n          :size=\"size\"\n          :disabled=\"disabled\"\n          :icon=\"icon\"\n        >{{text}}</Button>\n      </Upload>\n      <Tooltip transfer :content=\"title\" placement=\"top\">\n        <a @click=\"download\">{{currentValue.name}}</a>\n      </Tooltip>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { uploadFile } from \"@/api/index\";\nexport default {\n  name: \"fileUpload\",\n  props: {\n    value: Object,\n    size: String,\n    type: String,\n    ghost: {\n      type: Boolean,\n      default: false\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    },\n    shape: String,\n    icon: {\n      type: String,\n      default: \"ios-cloud-upload-outline\"\n    },\n    text: {\n      type: String,\n      default: \"上传文件\"\n    },\n    maxSize: {\n      type: Number,\n      default: 5\n    },\n    accept: String\n  },\n  computed: {\n    format() {\n      if (this.accept) {\n        let format = [];\n        this.accept.split(\",\").forEach(e => {\n          format.push(e.replace(\".\", \"\").replace(\" \", \"\"));\n        });\n        return format;\n      } else {\n        return [];\n      }\n    }\n  },\n  data() {\n    return {\n      accessToken: {},\n      title: \"点击下载\",\n      currentValue: this.value,\n      loading: false,\n      uploadFileUrl: uploadFile\n    };\n  },\n  methods: {\n    init() {\n      this.accessToken = {\n        accessToken: this.getStore(\"accessToken\")\n      };\n    },\n    download() {\n      if (!this.currentValue.url) {\n        this.$Message.error(\"无效的链接\");\n        return;\n      }\n      window.open(\n        this.currentValue.url +\n          \"?attname=&response-content-type=application/octet-stream&filename=\" +\n          this.currentValue.name\n      );\n    },\n    handleFormatError(file) {\n      this.loading = false;\n      this.$Notice.warning({\n        title: \"不支持的文件格式\",\n        desc:\n          \"所选文件‘ \" +\n          file.name +\n          \" ’格式不正确, 请选择 \" +\n          this.accept +\n          \" 格式文件\"\n      });\n    },\n    handleMaxSize(file) {\n      this.loading = false;\n      this.$Notice.warning({\n        title: \"文件大小过大\",\n        desc:\n          \"所选文件‘ \" +\n          file.name +\n          \" ’大小过大, 不得超过 \" +\n          this.maxSize +\n          \"M.\"\n      });\n    },\n    beforeUpload() {\n      this.loading = true;\n      return true;\n    },\n    handleSuccess(res, file) {\n      this.loading = false;\n      if (res.success) {\n        this.currentValue = {\n          url: res.result,\n          name: file.name,\n          size: file.size\n        };\n        this.title =\n          \"点击下载(\" +\n          ((file.size * 1.0) / (1024 * 1024)).toFixed(2) +\n          \" MB)\";\n        this.$emit(\"input\", this.currentValue);\n        this.$emit(\"on-change\", this.currentValue);\n      } else {\n        this.$Message.error(res.message);\n      }\n    },\n    handleError(error, file, fileList) {\n      this.loading = false;\n      this.$Message.error(error.toString());\n    },\n    handleChange(v) {\n      this.$emit(\"input\", this.currentValue);\n      this.$emit(\"on-change\", this.currentValue);\n    },\n    setCurrentValue(value) {\n      if (value === this.currentValue) {\n        return;\n      }\n      this.currentValue = value;\n      if (this.currentValue.size) {\n        this.title =\n          \"点击下载(\" +\n          ((this.currentValue.size * 1.0) / (1024 * 1024)).toFixed(2) +\n          \" MB)\";\n      } else {\n        this.title = \"点击下载\";\n      }\n      this.$emit(\"on-change\", this.currentValue);\n    }\n  },\n  watch: {\n    value(val) {\n      this.setCurrentValue(val);\n    }\n  },\n  mounted() {\n    this.init();\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.file-upload-wrap {\n  display: flex;\n  align-items: center;\n  .file-upload {\n    display: inline-block;\n    margin-right: 10px;\n  }\n}\n</style>\n\n"]}]}