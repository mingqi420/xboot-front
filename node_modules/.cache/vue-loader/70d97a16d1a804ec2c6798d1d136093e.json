{"remainingRequest":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\dove\\project\\xboot\\xboot-front-master\\src\\views\\sys\\role-manage\\roleManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\src\\views\\sys\\role-manage\\roleManage.vue","mtime":1600218271000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgZ2V0Um9sZUxpc3QsCiAgZ2V0QWxsUGVybWlzc2lvbkxpc3QsCiAgYWRkUm9sZSwKICBlZGl0Um9sZSwKICBkZWxldGVSb2xlLAogIHNldERlZmF1bHRSb2xlLAogIGVkaXRSb2xlUGVybSwKICBpbml0RGVwYXJ0bWVudCwKICBsb2FkRGVwYXJ0bWVudCwKICBlZGl0Um9sZURlcAp9IGZyb20gIkAvYXBpL2luZGV4IjsKaW1wb3J0IHV0aWwgZnJvbSAiQC9saWJzL3V0aWwuanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogInJvbGUtbWFuYWdlIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgb3BlblRpcDogdHJ1ZSwKICAgICAgb3BlbkxldmVsOiAiMCIsCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIHRyZWVMb2FkaW5nOiB0cnVlLAogICAgICBkZXBUcmVlTG9hZGluZzogdHJ1ZSwKICAgICAgc3VibWl0UGVybUxvYWRpbmc6IGZhbHNlLAogICAgICBzdWJtaXREZXBMb2FkaW5nOiBmYWxzZSwKICAgICAgc2VhcmNoS2V5OiAiIiwKICAgICAgc29ydENvbHVtbjogImNyZWF0ZVRpbWUiLAogICAgICBzb3J0VHlwZTogImRlc2MiLAogICAgICBtb2RhbFR5cGU6IDAsCiAgICAgIHJvbGVNb2RhbFZpc2libGU6IGZhbHNlLAogICAgICBwZXJtTW9kYWxWaXNpYmxlOiBmYWxzZSwKICAgICAgZGVwTW9kYWxWaXNpYmxlOiBmYWxzZSwKICAgICAgbW9kYWxUaXRsZTogIiIsCiAgICAgIHJvbGVGb3JtOiB7CiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgZGVzY3JpcHRpb246ICIiCiAgICAgIH0sCiAgICAgIHJvbGVGb3JtVmFsaWRhdGU6IHsKICAgICAgICBuYW1lOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuinkuiJsuWQjeensOS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9XQogICAgICB9LAogICAgICBzdWJtaXRMb2FkaW5nOiBmYWxzZSwKICAgICAgc2VsZWN0TGlzdDogW10sCiAgICAgIHNlbGVjdENvdW50OiAwLAogICAgICBjb2x1bW5zOiBbCiAgICAgICAgewogICAgICAgICAgdHlwZTogInNlbGVjdGlvbiIsCiAgICAgICAgICB3aWR0aDogNjAsCiAgICAgICAgICBhbGlnbjogImNlbnRlciIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJpbmRleCIsCiAgICAgICAgICB3aWR0aDogNjAsCiAgICAgICAgICBhbGlnbjogImNlbnRlciIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAi6KeS6Imy5ZCN56ewIiwKICAgICAgICAgIGtleTogIm5hbWUiLAogICAgICAgICAgd2lkdGg6IDE1MCwKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogIuWkh+azqCIsCiAgICAgICAgICBrZXk6ICJkZXNjcmlwdGlvbiIsCiAgICAgICAgICBtaW5XaWR0aDogMTUwLAogICAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAi5Yib5bu65pe26Ze0IiwKICAgICAgICAgIGtleTogImNyZWF0ZVRpbWUiLAogICAgICAgICAgd2lkdGg6IDE3MCwKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLAogICAgICAgICAgc29ydFR5cGU6ICJkZXNjIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICLmm7TmlrDml7bpl7QiLAogICAgICAgICAga2V5OiAidXBkYXRlVGltZSIsCiAgICAgICAgICB3aWR0aDogMTcwLAogICAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAi5piv5ZCm6K6+572u5Li65rOo5YaM55So5oi36buY6K6k6KeS6ImyIiwKICAgICAgICAgIGtleTogImRlZmF1bHRSb2xlIiwKICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgIHdpZHRoOiAyMjAsCiAgICAgICAgICByZW5kZXI6IChoLCBwYXJhbXMpID0+IHsKICAgICAgICAgICAgaWYgKHBhcmFtcy5yb3cuZGVmYXVsdFJvbGUpIHsKICAgICAgICAgICAgICByZXR1cm4gaCgiZGl2IiwgWwogICAgICAgICAgICAgICAgaCgKICAgICAgICAgICAgICAgICAgIkJ1dHRvbiIsCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwcm9wczogewogICAgICAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgICAgc2l6ZTogInNtYWxsIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHsKICAgICAgICAgICAgICAgICAgICAgIG1hcmdpblJpZ2h0OiAiNXB4IgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgb246IHsKICAgICAgICAgICAgICAgICAgICAgIGNsaWNrOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsRGVmYXVsdChwYXJhbXMucm93KTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICLlj5bmtojpu5jorqQiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmV0dXJuIGgoImRpdiIsIFsKICAgICAgICAgICAgICAgIGgoCiAgICAgICAgICAgICAgICAgICJCdXR0b24iLAogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcHJvcHM6IHsKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJpbmZvIiwKICAgICAgICAgICAgICAgICAgICAgIHNpemU6ICJzbWFsbCIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5SaWdodDogIjVweCIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgICAgICAgICAgICBjbGljazogKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldERlZmF1bHQocGFyYW1zLnJvdyk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAi6K6+5Li66buY6K6kIgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgIF0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogIuaTjeS9nCIsCiAgICAgICAgICBrZXk6ICJhY3Rpb24iLAogICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgZml4ZWQ6ICJyaWdodCIsCiAgICAgICAgICB3aWR0aDogMzAwLAogICAgICAgICAgcmVuZGVyOiAoaCwgcGFyYW1zKSA9PiB7CiAgICAgICAgICAgIHJldHVybiBoKCJkaXYiLCBbCiAgICAgICAgICAgICAgaCgKICAgICAgICAgICAgICAgICJCdXR0b24iLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBwcm9wczogewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICBzaXplOiAic21hbGwiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgICAgICAgICAgbWFyZ2luUmlnaHQ6ICI1cHgiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgICAgICAgICAgY2xpY2s6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdFBlcm0ocGFyYW1zLnJvdyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgIuiPnOWNleadg+mZkCIKICAgICAgICAgICAgICApLAogICAgICAgICAgICAgIGgoCiAgICAgICAgICAgICAgICAiQnV0dG9uIiwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgcHJvcHM6IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAicHJpbWFyeSIsCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogInNtYWxsIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBzdHlsZTogewogICAgICAgICAgICAgICAgICAgIG1hcmdpblJpZ2h0OiAiNXB4IgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBvbjogewogICAgICAgICAgICAgICAgICAgIGNsaWNrOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXREZXAocGFyYW1zLnJvdyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgIuaVsOaNruadg+mZkCIKICAgICAgICAgICAgICApLAogICAgICAgICAgICAgIGgoCiAgICAgICAgICAgICAgICAiQnV0dG9uIiwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgcHJvcHM6IHsKICAgICAgICAgICAgICAgICAgICBzaXplOiAic21hbGwiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgICAgICAgICAgbWFyZ2luUmlnaHQ6ICI1cHgiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgICAgICAgICAgY2xpY2s6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdChwYXJhbXMucm93KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAi57yW6L6RIgogICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgaCgKICAgICAgICAgICAgICAgICJCdXR0b24iLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBwcm9wczogewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogInNtYWxsIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBvbjogewogICAgICAgICAgICAgICAgICAgIGNsaWNrOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZShwYXJhbXMucm93KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAi5Yig6ZmkIgogICAgICAgICAgICAgICkKICAgICAgICAgICAgXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICBdLAogICAgICBkYXRhOiBbXSwKICAgICAgcGFnZU51bWJlcjogMSwKICAgICAgcGFnZVNpemU6IDEwLAogICAgICB0b3RhbDogMCwKICAgICAgcGVybURhdGE6IFtdLAogICAgICBlZGl0Um9sZVBlcm1JZDogIiIsCiAgICAgIHNlbGVjdEFsbEZsYWc6IGZhbHNlLAogICAgICBkZXBEYXRhOiBbXSwKICAgICAgZGF0YVR5cGU6IDAsCiAgICAgIGVkaXREZXBhcnRtZW50czogW10KICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0KCkgewogICAgICB0aGlzLmdldFJvbGVMaXN0KCk7CiAgICAgIC8vIOiOt+WPluaJgOacieiPnOWNleadg+mZkOagkQogICAgICB0aGlzLmdldFBlcm1MaXN0KCk7CiAgICB9LAogICAgcmVuZGVyQ29udGVudChoLCB7IHJvb3QsIG5vZGUsIGRhdGEgfSkgewogICAgICBsZXQgaWNvbiA9ICIiOwogICAgICBpZiAoZGF0YS5sZXZlbCA9PSAwKSB7CiAgICAgICAgaWNvbiA9ICJpb3MtbmF2aWdhdGUiOwogICAgICB9IGVsc2UgaWYgKGRhdGEubGV2ZWwgPT0gMSkgewogICAgICAgIGljb24gPSAibWQtbGlzdC1ib3giOwogICAgICB9IGVsc2UgaWYgKGRhdGEubGV2ZWwgPT0gMikgewogICAgICAgIGljb24gPSAibWQtbGlzdCI7CiAgICAgIH0gZWxzZSBpZiAoZGF0YS5sZXZlbCA9PSAzKSB7CiAgICAgICAgaWNvbiA9ICJtZC1yYWRpby1idXR0b24tb24iOwogICAgICB9IGVsc2UgewogICAgICAgIGljb24gPSAibWQtcmFkaW8tYnV0dG9uLW9mZiI7CiAgICAgIH0KICAgICAgcmV0dXJuIGgoCiAgICAgICAgInNwYW4iLAogICAgICAgIHsKICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgIGRpc3BsYXk6ICJpbmxpbmUtYmxvY2siLAogICAgICAgICAgICBjdXJzb3I6ICJwb2ludGVyIgogICAgICAgICAgfSwKICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgIGNsaWNrOiAoKSA9PiB7CiAgICAgICAgICAgICAgZGF0YS5jaGVja2VkID0gIWRhdGEuY2hlY2tlZDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgWwogICAgICAgICAgaCgic3BhbiIsIFsKICAgICAgICAgICAgaCgiSWNvbiIsIHsKICAgICAgICAgICAgICBwcm9wczogewogICAgICAgICAgICAgICAgdHlwZTogaWNvbiwKICAgICAgICAgICAgICAgIHNpemU6ICIxNiIKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgICAgICAibWFyZ2luLXJpZ2h0IjogIjhweCIsCiAgICAgICAgICAgICAgICAibWFyZ2luLWJvdHRvbSI6ICIzcHgiCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSwKICAgICAgICAgICAgaCgic3BhbiIsIGRhdGEudGl0bGUpCiAgICAgICAgICBdKQogICAgICAgIF0KICAgICAgKTsKICAgIH0sCiAgICBjaGFuZ2VQYWdlKHYpIHsKICAgICAgdGhpcy5wYWdlTnVtYmVyID0gdjsKICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOwogICAgICB0aGlzLmNsZWFyU2VsZWN0QWxsKCk7CiAgICB9LAogICAgY2hhbmdlUGFnZVNpemUodikgewogICAgICB0aGlzLnBhZ2VTaXplID0gdjsKICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOwogICAgfSwKICAgIGNoYW5nZVNvcnQoZSkgewogICAgICB0aGlzLnNvcnRDb2x1bW4gPSBlLmtleTsKICAgICAgdGhpcy5zb3J0VHlwZSA9IGUub3JkZXI7CiAgICAgIGlmIChlLm9yZGVyID09ICJub3JtYWwiKSB7CiAgICAgICAgdGhpcy5zb3J0VHlwZSA9ICIiOwogICAgICB9CiAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKTsKICAgIH0sCiAgICBnZXRSb2xlTGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICBwYWdlTnVtYmVyOiB0aGlzLnBhZ2VOdW1iZXIsCiAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZVNpemUsCiAgICAgICAgc29ydDogdGhpcy5zb3J0Q29sdW1uLAogICAgICAgIG9yZGVyOiB0aGlzLnNvcnQKICAgICAgfTsKICAgICAgZ2V0Um9sZUxpc3QocGFyYW1zKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICB0aGlzLmRhdGEgPSByZXMucmVzdWx0LmNvbnRlbnQ7CiAgICAgICAgICB0aGlzLnRvdGFsID0gcmVzLnJlc3VsdC50b3RhbEVsZW1lbnRzOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZ2V0UGVybUxpc3QoKSB7CiAgICAgIHRoaXMudHJlZUxvYWRpbmcgPSB0cnVlOwogICAgICBnZXRBbGxQZXJtaXNzaW9uTGlzdCgpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHRoaXMuZGVsZXRlRGlzYWJsZU5vZGUocmVzLnJlc3VsdCk7CiAgICAgICAgICB0aGlzLnBlcm1EYXRhID0gcmVzLnJlc3VsdDsKICAgICAgICAgIHRoaXMudHJlZUxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgdGhpcy50cmVlTG9hZGluZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDpgJLlvZLmoIforrDnpoHnlKjoioLngrkKICAgIGRlbGV0ZURpc2FibGVOb2RlKHBlcm1EYXRhKSB7CiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgcGVybURhdGEuZm9yRWFjaChmdW5jdGlvbihlKSB7CiAgICAgICAgaWYgKGUuc3RhdHVzID09IC0xKSB7CiAgICAgICAgICBlLnRpdGxlID0gIlvlt7LnpoHnlKhdICIgKyBlLnRpdGxlOwogICAgICAgICAgZS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChlLmNoaWxkcmVuICYmIGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhhdC5kZWxldGVEaXNhYmxlTm9kZShlLmNoaWxkcmVuKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNhbmNlbFJvbGUoKSB7CiAgICAgIHRoaXMucm9sZU1vZGFsVmlzaWJsZSA9IGZhbHNlOwogICAgfSwKICAgIHN1Ym1pdFJvbGUoKSB7CiAgICAgIHRoaXMuJHJlZnMucm9sZUZvcm0udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgaWYgKHRoaXMubW9kYWxUeXBlID09IDApIHsKICAgICAgICAgICAgLy8g5re75YqgCiAgICAgICAgICAgIHRoaXMuc3VibWl0TG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgIGFkZFJvbGUodGhpcy5yb2xlRm9ybSkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgIHRoaXMuc3VibWl0TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5zdWNjZXNzKCLmk43kvZzmiJDlip8iKTsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKTsKICAgICAgICAgICAgICAgIHRoaXMucm9sZU1vZGFsVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnN1Ym1pdExvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICBlZGl0Um9sZSh0aGlzLnJvbGVGb3JtKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgdGhpcy5zdWJtaXRMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MoIuaTjeS9nOaIkOWKnyIpOwogICAgICAgICAgICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOwogICAgICAgICAgICAgICAgdGhpcy5yb2xlTW9kYWxWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGFkZFJvbGUoKSB7CiAgICAgIHRoaXMubW9kYWxUeXBlID0gMDsKICAgICAgdGhpcy5tb2RhbFRpdGxlID0gIua3u+WKoOinkuiJsiI7CiAgICAgIHRoaXMuJHJlZnMucm9sZUZvcm0ucmVzZXRGaWVsZHMoKTsKICAgICAgZGVsZXRlIHRoaXMucm9sZUZvcm0uaWQ7CiAgICAgIHRoaXMucm9sZU1vZGFsVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgZWRpdCh2KSB7CiAgICAgIHRoaXMubW9kYWxUeXBlID0gMTsKICAgICAgdGhpcy5tb2RhbFRpdGxlID0gIue8lui+keinkuiJsiI7CiAgICAgIHRoaXMuJHJlZnMucm9sZUZvcm0ucmVzZXRGaWVsZHMoKTsKICAgICAgLy8g6L2s5o2ibnVsbOS4uiIiCiAgICAgIGZvciAobGV0IGF0dHIgaW4gdikgewogICAgICAgIGlmICh2W2F0dHJdID09IG51bGwpIHsKICAgICAgICAgIHZbYXR0cl0gPSAiIjsKICAgICAgICB9CiAgICAgIH0KICAgICAgbGV0IHN0ciA9IEpTT04uc3RyaW5naWZ5KHYpOwogICAgICBsZXQgcm9sZUluZm8gPSBKU09OLnBhcnNlKHN0cik7CiAgICAgIHRoaXMucm9sZUZvcm0gPSByb2xlSW5mbzsKICAgICAgdGhpcy5yb2xlTW9kYWxWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICByZW1vdmUodikgewogICAgICB0aGlzLiRNb2RhbC5jb25maXJtKHsKICAgICAgICB0aXRsZTogIuehruiupOWIoOmZpCIsCiAgICAgICAgY29udGVudDogIuaCqOehruiupOimgeWIoOmZpOinkuiJsiAiICsgdi5uYW1lICsgIiA/IiwKICAgICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAgIG9uT2s6ICgpID0+IHsKICAgICAgICAgIGRlbGV0ZVJvbGUoe2lkczogdi5pZH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgdGhpcy4kTW9kYWwucmVtb3ZlKCk7CiAgICAgICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2Uuc3VjY2Vzcygi5Yig6Zmk5oiQ5YqfIik7CiAgICAgICAgICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHNldERlZmF1bHQodikgewogICAgICB0aGlzLiRNb2RhbC5jb25maXJtKHsKICAgICAgICB0aXRsZTogIuehruiupOiuvue9riIsCiAgICAgICAgY29udGVudDogIuaCqOehruiupOimgeiuvue9ruaJgOmAieeahCAiICsgdi5uYW1lICsgIiDkuLrms6jlhoznlKjmiLfpu5jorqTop5LoibI/IiwKICAgICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAgIG9uT2s6ICgpID0+IHsKICAgICAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgICAgIGlkOiB2LmlkLAogICAgICAgICAgICBpc0RlZmF1bHQ6IHRydWUKICAgICAgICAgIH07CiAgICAgICAgICBzZXREZWZhdWx0Um9sZShwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgdGhpcy4kTW9kYWwucmVtb3ZlKCk7CiAgICAgICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2Uuc3VjY2Vzcygi5pON5L2c5oiQ5YqfIik7CiAgICAgICAgICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNhbmNlbERlZmF1bHQodikgewogICAgICB0aGlzLiRNb2RhbC5jb25maXJtKHsKICAgICAgICB0aXRsZTogIuehruiupOWPlua2iCIsCiAgICAgICAgY29udGVudDogIuaCqOehruiupOimgeWPlua2iOaJgOmAieeahCAiICsgdi5uYW1lICsgIiDop5LoibLkuLrpu5jorqQ/IiwKICAgICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAgIG9uT2s6ICgpID0+IHsKICAgICAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgICAgIGlkOiB2LmlkLAogICAgICAgICAgICBpc0RlZmF1bHQ6IGZhbHNlCiAgICAgICAgICB9OwogICAgICAgICAgc2V0RGVmYXVsdFJvbGUocGFyYW1zKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIHRoaXMuJE1vZGFsLnJlbW92ZSgpOwogICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MoIuaTjeS9nOaIkOWKnyIpOwogICAgICAgICAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjbGVhclNlbGVjdEFsbCgpIHsKICAgICAgdGhpcy4kcmVmcy50YWJsZS5zZWxlY3RBbGwoZmFsc2UpOwogICAgfSwKICAgIGNoYW5nZVNlbGVjdChlKSB7CiAgICAgIHRoaXMuc2VsZWN0TGlzdCA9IGU7CiAgICAgIHRoaXMuc2VsZWN0Q291bnQgPSBlLmxlbmd0aDsKICAgIH0sCiAgICBkZWxBbGwoKSB7CiAgICAgIGlmICh0aGlzLnNlbGVjdENvdW50IDw9IDApIHsKICAgICAgICB0aGlzLiRNZXNzYWdlLndhcm5pbmcoIuaCqOi/mOacqumAieaLqeimgeWIoOmZpOeahOaVsOaNriIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLiRNb2RhbC5jb25maXJtKHsKICAgICAgICB0aXRsZTogIuehruiupOWIoOmZpCIsCiAgICAgICAgY29udGVudDogIuaCqOehruiupOimgeWIoOmZpOaJgOmAieeahCAiICsgdGhpcy5zZWxlY3RDb3VudCArICIg5p2h5pWw5o2uPyIsCiAgICAgICAgbG9hZGluZzogdHJ1ZSwKICAgICAgICBvbk9rOiAoKSA9PiB7CiAgICAgICAgICBsZXQgaWRzID0gIiI7CiAgICAgICAgICB0aGlzLnNlbGVjdExpc3QuZm9yRWFjaChmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIGlkcyArPSBlLmlkICsgIiwiOwogICAgICAgICAgfSk7CiAgICAgICAgICBpZHMgPSBpZHMuc3Vic3RyaW5nKDAsIGlkcy5sZW5ndGggLSAxKTsKICAgICAgICAgIGRlbGV0ZVJvbGUoe2lkczogaWRzfSkudGhlbihyZXMgPT4gewogICAgICAgICAgICB0aGlzLiRNb2RhbC5yZW1vdmUoKTsKICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5zdWNjZXNzKCLliKDpmaTmiJDlip8iKTsKICAgICAgICAgICAgICB0aGlzLmNsZWFyU2VsZWN0QWxsKCk7CiAgICAgICAgICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGVkaXRQZXJtKHYpIHsKICAgICAgdGhpcy5lZGl0Um9sZVBlcm1JZCA9IHYuaWQ7CiAgICAgIHRoaXMubW9kYWxUaXRsZSA9ICLliIbphY0gIiArIHYubmFtZSArICIg55qE6I+c5Y2V5p2D6ZmQIjsKICAgICAgLy8g5Yy56YWN5Yu+6YCJCiAgICAgIGxldCByb2xlUGVybXMgPSB2LnBlcm1pc3Npb25zOwogICAgICBpZiAodGhpcy50cmVlTG9hZGluZykgewogICAgICAgIHRoaXMuJE1lc3NhZ2Uud2FybmluZygi6I+c5Y2V5p2D6ZmQ5pWw5o2u5Yqg6L295Lit77yM6K+356iN5ZCO54K55Ye75p+l55yLIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8vIOmAkuW9kuWIpOaWreWtkOiKgueCuQogICAgICB0aGlzLmNoZWNrUGVybVRyZWUodGhpcy5wZXJtRGF0YSwgcm9sZVBlcm1zKTsKICAgICAgdGhpcy5wZXJtTW9kYWxWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICAvLyDpgJLlvZLliKTmlq3lrZDoioLngrkKICAgIGNoZWNrUGVybVRyZWUocGVybURhdGEsIHJvbGVQZXJtcykgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIHBlcm1EYXRhLmZvckVhY2goZnVuY3Rpb24ocCkgewogICAgICAgIGlmICh0aGF0Lmhhc1Blcm0ocCwgcm9sZVBlcm1zKSAmJiBwLnN0YXR1cyAhPSAtMSkgewogICAgICAgICAgcC5jaGVja2VkID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcC5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGlmIChwLmNoaWxkcmVuICYmIHAuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhhdC5jaGVja1Blcm1UcmVlKHAuY2hpbGRyZW4sIHJvbGVQZXJtcyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyDliKTmlq3op5LoibLmi6XmnInnmoTmnYPpmZDoioLngrnli77pgIkKICAgIGhhc1Blcm0ocCwgcm9sZVBlcm1zKSB7CiAgICAgIGxldCBmbGFnID0gZmFsc2U7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm9sZVBlcm1zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHAuaWQgPT0gcm9sZVBlcm1zW2ldLnBlcm1pc3Npb25JZCkgewogICAgICAgICAgZmxhZyA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGZsYWcpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgLy8g5YWo6YCJ5Y+N6YCJCiAgICBzZWxlY3RUcmVlQWxsKCkgewogICAgICB0aGlzLnNlbGVjdEFsbEZsYWcgPSAhdGhpcy5zZWxlY3RBbGxGbGFnOwogICAgICBsZXQgc2VsZWN0ID0gdGhpcy5zZWxlY3RBbGxGbGFnOwogICAgICB0aGlzLnNlbGVjdGVkVHJlZUFsbCh0aGlzLnBlcm1EYXRhLCBzZWxlY3QpOwogICAgfSwKICAgIC8vIOmAkuW9kuWFqOmAieiKgueCuQogICAgc2VsZWN0ZWRUcmVlQWxsKHBlcm1EYXRhLCBzZWxlY3QpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICBwZXJtRGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGUpIHsKICAgICAgICBlLmNoZWNrZWQgPSBzZWxlY3Q7CiAgICAgICAgaWYgKGUuY2hpbGRyZW4gJiYgZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0aGF0LnNlbGVjdGVkVHJlZUFsbChlLmNoaWxkcmVuLCBzZWxlY3QpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgc3VibWl0UGVybUVkaXQoKSB7CiAgICAgIHRoaXMuc3VibWl0UGVybUxvYWRpbmcgPSB0cnVlOwogICAgICBsZXQgcGVybUlkcyA9ICIiOwogICAgICBsZXQgc2VsZWN0ZWROb2RlcyA9IHRoaXMuJHJlZnMudHJlZS5nZXRDaGVja2VkTm9kZXMoKTsKICAgICAgc2VsZWN0ZWROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKGUpIHsKICAgICAgICBwZXJtSWRzICs9IGUuaWQgKyAiLCI7CiAgICAgIH0pOwogICAgICBwZXJtSWRzID0gcGVybUlkcy5zdWJzdHJpbmcoMCwgcGVybUlkcy5sZW5ndGggLSAxKTsKICAgICAgZWRpdFJvbGVQZXJtKHsKICAgICAgICByb2xlSWQ6IHRoaXMuZWRpdFJvbGVQZXJtSWQsCiAgICAgICAgcGVybUlkczogcGVybUlkcwogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5zdWJtaXRQZXJtTG9hZGluZyA9IGZhbHNlOwogICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgdGhpcy4kTWVzc2FnZS5zdWNjZXNzKCLmk43kvZzmiJDlip8iKTsKICAgICAgICAgIC8vIOagh+iusOmHjeaWsOiOt+WPluiPnOWNleaVsOaNrgogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRBZGRlZCIsIGZhbHNlKTsKICAgICAgICAgIHV0aWwuaW5pdFJvdXRlcih0aGlzKTsKICAgICAgICAgIHRoaXMuZ2V0Um9sZUxpc3QoKTsKICAgICAgICAgIHRoaXMucGVybU1vZGFsVmlzaWJsZSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2FuY2VsUGVybUVkaXQoKSB7CiAgICAgIHRoaXMucGVybU1vZGFsVmlzaWJsZSA9IGZhbHNlOwogICAgfSwKICAgIGxvYWREYXRhKGl0ZW0sIGNhbGxiYWNrKSB7CiAgICAgIGxvYWREZXBhcnRtZW50KGl0ZW0uaWQsIHsgb3BlbkRhdGFGaWx0ZXI6IGZhbHNlIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHJlcy5yZXN1bHQuZm9yRWFjaChmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIGUuc2VsZWN0ZWQgPSBmYWxzZTsKICAgICAgICAgICAgaWYgKGUuaXNQYXJlbnQpIHsKICAgICAgICAgICAgICBlLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICBlLmNoaWxkcmVuID0gW107CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGUuc3RhdHVzID09IC0xKSB7CiAgICAgICAgICAgICAgZS50aXRsZSA9ICJb5bey56aB55SoXSAiICsgZS50aXRsZTsKICAgICAgICAgICAgICBlLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBjYWxsYmFjayhyZXMucmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGVkaXREZXAodikgewogICAgICB0aGlzLmRhdGFUeXBlID0gMDsKICAgICAgdGhpcy5lZGl0Um9sZVBlcm1JZCA9IHYuaWQ7CiAgICAgIHRoaXMubW9kYWxUaXRsZSA9ICLliIbphY0gIiArIHYubmFtZSArICIg55qE5pWw5o2u5p2D6ZmQIjsKICAgICAgaWYgKHYuZGF0YVR5cGUpIHsKICAgICAgICB0aGlzLmRhdGFUeXBlID0gdi5kYXRhVHlwZTsKICAgICAgfQogICAgICAvLyDljLnphY3li77pgIkKICAgICAgbGV0IHJvbGVEZXBJZHMgPSB2LmRlcGFydG1lbnRzOwogICAgICB0aGlzLmVkaXREZXBhcnRtZW50cyA9IHJvbGVEZXBJZHM7CiAgICAgIHRoaXMuZGVwVHJlZUxvYWRpbmcgPSB0cnVlOwogICAgICBpbml0RGVwYXJ0bWVudCh7IG9wZW5EYXRhRmlsdGVyOiBmYWxzZSB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5kZXBUcmVlTG9hZGluZyA9IGZhbHNlOwogICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgcmVzLnJlc3VsdC5mb3JFYWNoKGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgZS5zZWxlY3RlZCA9IGZhbHNlOwogICAgICAgICAgICBpZiAoZS5pc1BhcmVudCkgewogICAgICAgICAgICAgIGUubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIGUuY2hpbGRyZW4gPSBbXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZS5zdGF0dXMgPT0gLTEpIHsKICAgICAgICAgICAgICBlLnRpdGxlID0gIlvlt7LnpoHnlKhdICIgKyBlLnRpdGxlOwogICAgICAgICAgICAgIGUuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuZGVwRGF0YSA9IHJlcy5yZXN1bHQ7CiAgICAgICAgICAvLyDliKTmlq3lrZDoioLngrkKICAgICAgICAgIHRoaXMuY2hlY2tEZXBUcmVlKHRoaXMuZGVwRGF0YSwgcm9sZURlcElkcyk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5kZXBNb2RhbFZpc2libGUgPSB0cnVlOwogICAgfSwKICAgIGV4cGFuZENoZWNrRGVwKHYpIHsKICAgICAgLy8g5Yik5pat5bGV5byA5a2Q6IqC54K5CiAgICAgIHRoaXMuY2hlY2tEZXBUcmVlKHYuY2hpbGRyZW4sIHRoaXMuZWRpdERlcGFydG1lbnRzKTsKICAgIH0sCiAgICAvLyDliKTmlq3lrZDoioLngrkKICAgIGNoZWNrRGVwVHJlZShkZXBEYXRhLCByb2xlRGVwSWRzKSB7CiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgZGVwRGF0YS5mb3JFYWNoKGZ1bmN0aW9uKHApIHsKICAgICAgICBpZiAodGhhdC5oYXNEZXBQZXJtKHAsIHJvbGVEZXBJZHMpKSB7CiAgICAgICAgICBwLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcC5zZWxlY3RlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g5Yik5pat6KeS6Imy5oul5pyJ55qE5p2D6ZmQ6IqC54K55Yu+6YCJCiAgICBoYXNEZXBQZXJtKHAsIHJvbGVEZXBJZHMpIHsKICAgICAgbGV0IGZsYWcgPSBmYWxzZTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb2xlRGVwSWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHAuaWQgPT0gcm9sZURlcElkc1tpXS5kZXBhcnRtZW50SWQpIHsKICAgICAgICAgIGZsYWcgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChmbGFnKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHN1Ym1pdERlcEVkaXQoKSB7CiAgICAgIGxldCBkZXBJZHMgPSAiIjsKICAgICAgaWYgKHRoaXMuZGF0YVR5cGUgPT0gMSkgewogICAgICAgIGxldCBzZWxlY3RlZE5vZGVzID0gdGhpcy4kcmVmcy5kZXBUcmVlLmdldFNlbGVjdGVkTm9kZXMoKTsKICAgICAgICBzZWxlY3RlZE5vZGVzLmZvckVhY2goZnVuY3Rpb24oZSkgewogICAgICAgICAgZGVwSWRzICs9IGUuaWQgKyAiLCI7CiAgICAgICAgfSk7CiAgICAgICAgZGVwSWRzID0gZGVwSWRzLnN1YnN0cmluZygwLCBkZXBJZHMubGVuZ3RoIC0gMSk7CiAgICAgIH0KICAgICAgdGhpcy5zdWJtaXREZXBMb2FkaW5nID0gdHJ1ZTsKICAgICAgZWRpdFJvbGVEZXAoewogICAgICAgIHJvbGVJZDogdGhpcy5lZGl0Um9sZVBlcm1JZCwKICAgICAgICBkYXRhVHlwZTogdGhpcy5kYXRhVHlwZSwKICAgICAgICBkZXBJZHM6IGRlcElkcwogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5zdWJtaXREZXBMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICB0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MoIuaTjeS9nOaIkOWKnyIpOwogICAgICAgICAgdGhpcy5nZXRSb2xlTGlzdCgpOwogICAgICAgICAgdGhpcy5kZXBNb2RhbFZpc2libGUgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNoYW5nZU9wZW4odikgewogICAgICBpZiAodiA9PSAiMCIpIHsKICAgICAgICB0aGlzLnBlcm1EYXRhLmZvckVhY2goZSA9PiB7CiAgICAgICAgICBlLmV4cGFuZCA9IHRydWU7CiAgICAgICAgICBpZiAoZS5jaGlsZHJlbiAmJiBlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgZS5jaGlsZHJlbi5mb3JFYWNoKGMgPT4gewogICAgICAgICAgICAgIGMuZXhwYW5kID0gdHJ1ZTsKICAgICAgICAgICAgICBpZiAoYy5jaGlsZHJlbiAmJiBjLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGMuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgIGIuZXhwYW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodiA9PSAiMSIpIHsKICAgICAgICB0aGlzLnBlcm1EYXRhLmZvckVhY2goZSA9PiB7CiAgICAgICAgICBlLmV4cGFuZCA9IGZhbHNlOwogICAgICAgICAgaWYgKGUuY2hpbGRyZW4gJiYgZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGUuY2hpbGRyZW4uZm9yRWFjaChjID0+IHsKICAgICAgICAgICAgICBjLmV4cGFuZCA9IGZhbHNlOwogICAgICAgICAgICAgIGlmIChjLmNoaWxkcmVuICYmIGMuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgYy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgYi5leHBhbmQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodiA9PSAiMiIpIHsKICAgICAgICB0aGlzLnBlcm1EYXRhLmZvckVhY2goZSA9PiB7CiAgICAgICAgICBlLmV4cGFuZCA9IHRydWU7CiAgICAgICAgICBpZiAoZS5jaGlsZHJlbiAmJiBlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgZS5jaGlsZHJlbi5mb3JFYWNoKGMgPT4gewogICAgICAgICAgICAgIGMuZXhwYW5kID0gZmFsc2U7CiAgICAgICAgICAgICAgaWYgKGMuY2hpbGRyZW4gJiYgYy5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBjLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oYikgewogICAgICAgICAgICAgICAgICBiLmV4cGFuZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh2ID09ICIzIikgewogICAgICAgIHRoaXMucGVybURhdGEuZm9yRWFjaChlID0+IHsKICAgICAgICAgIGUuZXhwYW5kID0gdHJ1ZTsKICAgICAgICAgIGlmIChlLmNoaWxkcmVuICYmIGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICBlLmNoaWxkcmVuLmZvckVhY2goYyA9PiB7CiAgICAgICAgICAgICAgYy5leHBhbmQgPSB0cnVlOwogICAgICAgICAgICAgIGlmIChjLmNoaWxkcmVuICYmIGMuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgYy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgYi5leHBhbmQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmluaXQoKTsKICB9Cn07Cg=="},{"version":3,"sources":["roleManage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"roleManage.vue","sourceRoot":"src/views/sys/role-manage","sourcesContent":["<style lang=\"less\">\n@import \"../../../styles/table-common.less\";\n@import \"./roleManage.less\";\n</style>\n<template>\n  <div class=\"search\">\n    <Card>\n      <Row class=\"operation\">\n        <Button @click=\"addRole\" type=\"primary\" icon=\"md-add\">添加角色</Button>\n        <Button @click=\"delAll\" icon=\"md-trash\">批量删除</Button>\n        <Button @click=\"init\" icon=\"md-refresh\">刷新</Button>\n        <Button type=\"dashed\" @click=\"openTip=!openTip\">{{openTip ? \"关闭提示\" : \"开启提示\"}}</Button>\n      </Row>\n      <Row v-show=\"openTip\">\n        <Alert show-icon>\n          已选择\n          <span class=\"select-count\">{{selectCount}}</span> 项\n          <a class=\"select-clear\" @click=\"clearSelectAll\">清空</a>\n        </Alert>\n      </Row>\n      <Row>\n        <Table\n          :loading=\"loading\"\n          border\n          :columns=\"columns\"\n          :data=\"data\"\n          ref=\"table\"\n          sortable=\"custom\"\n          @on-sort-change=\"changeSort\"\n          @on-selection-change=\"changeSelect\"\n        ></Table>\n      </Row>\n      <Row type=\"flex\" justify=\"end\" class=\"page\">\n        <Page\n          :current=\"pageNumber\"\n          :total=\"total\"\n          :page-size=\"pageSize\"\n          @on-change=\"changePage\"\n          @on-page-size-change=\"changePageSize\"\n          :page-size-opts=\"[10,20,50]\"\n          size=\"small\"\n          show-total\n          show-elevator\n          show-sizer\n        ></Page>\n      </Row>\n    </Card>\n\n    <!-- 编辑 -->\n    <Modal :title=\"modalTitle\" v-model=\"roleModalVisible\" :mask-closable=\"false\" :width=\"500\">\n      <Form ref=\"roleForm\" :model=\"roleForm\" :label-width=\"80\" :rules=\"roleFormValidate\">\n        <FormItem label=\"角色名称\" prop=\"name\">\n          <Input v-model=\"roleForm.name\" placeholder=\"按照Spring Security约定建议以‘ROLE_’开头\" />\n        </FormItem>\n        <FormItem label=\"备注\" prop=\"description\">\n          <Input v-model=\"roleForm.description\" />\n        </FormItem>\n      </Form>\n      <div slot=\"footer\">\n        <Button type=\"text\" @click=\"cancelRole\">取消</Button>\n        <Button type=\"primary\" :loading=\"submitLoading\" @click=\"submitRole\">提交</Button>\n      </div>\n    </Modal>\n    <!-- 菜单权限 -->\n    <Modal\n      :title=\"modalTitle\"\n      v-model=\"permModalVisible\"\n      :mask-closable=\"false\"\n      :width=\"500\"\n      :styles=\"{top: '30px'}\"\n      class=\"permModal\"\n    >\n      <div style=\"position:relative\">\n        <Tree\n          ref=\"tree\"\n          :data=\"permData\"\n          show-checkbox\n          :render=\"renderContent\"\n          :check-strictly=\"true\"\n        ></Tree>\n        <Spin size=\"large\" fix v-if=\"treeLoading\"></Spin>\n      </div>\n      <div slot=\"footer\">\n        <Button type=\"text\" @click=\"cancelPermEdit\">取消</Button>\n        <Select\n          v-model=\"openLevel\"\n          @on-change=\"changeOpen\"\n          style=\"width:110px;text-align:left;margin-right:10px\"\n        >\n          <Option value=\"0\">展开所有</Option>\n          <Option value=\"1\">收合所有</Option>\n          <Option value=\"2\">仅展开一级</Option>\n          <Option value=\"3\">仅展开两级</Option>\n        </Select>\n        <Button @click=\"selectTreeAll\">全选/反选</Button>\n        <Button type=\"primary\" :loading=\"submitPermLoading\" @click=\"submitPermEdit\">提交</Button>\n      </div>\n    </Modal>\n    <!-- 数据权限 -->\n    <Modal\n      :title=\"modalTitle\"\n      v-model=\"depModalVisible\"\n      :mask-closable=\"false\"\n      :width=\"500\"\n      class=\"depModal\"\n    >\n      <Alert show-icon>默认可查看全部数据，自定义数据范围时请勾选下方数据</Alert>\n      <Form :label-width=\"85\">\n        <FormItem label=\"数据范围\">\n          <Select v-model=\"dataType\" transfer>\n            <Option :value=\"0\">全部数据权限</Option>\n            <Option :value=\"1\">自定义数据权限</Option>\n            <Option :value=\"2\">本部门及以下数据权限</Option>\n            <Option :value=\"3\">本部门数据权限</Option>\n          </Select>\n        </FormItem>\n      </Form>\n      <div v-show=\"dataType==1\" style=\"margin-top:15px\">\n        <div style=\"position:relative\">\n          <Tree\n            ref=\"depTree\"\n            :data=\"depData\"\n            :load-data=\"loadData\"\n            @on-toggle-expand=\"expandCheckDep\"\n            multiple\n            style=\"margin-top:15px\"\n          ></Tree>\n          <Spin size=\"large\" fix v-if=\"depTreeLoading\"></Spin>\n        </div>\n      </div>\n      <div slot=\"footer\">\n        <Button type=\"text\" @click=\"depModalVisible=false\">取消</Button>\n        <Button type=\"primary\" :loading=\"submitDepLoading\" @click=\"submitDepEdit\">提交</Button>\n      </div>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport {\n  getRoleList,\n  getAllPermissionList,\n  addRole,\n  editRole,\n  deleteRole,\n  setDefaultRole,\n  editRolePerm,\n  initDepartment,\n  loadDepartment,\n  editRoleDep\n} from \"@/api/index\";\nimport util from \"@/libs/util.js\";\nexport default {\n  name: \"role-manage\",\n  data() {\n    return {\n      openTip: true,\n      openLevel: \"0\",\n      loading: true,\n      treeLoading: true,\n      depTreeLoading: true,\n      submitPermLoading: false,\n      submitDepLoading: false,\n      searchKey: \"\",\n      sortColumn: \"createTime\",\n      sortType: \"desc\",\n      modalType: 0,\n      roleModalVisible: false,\n      permModalVisible: false,\n      depModalVisible: false,\n      modalTitle: \"\",\n      roleForm: {\n        name: \"\",\n        description: \"\"\n      },\n      roleFormValidate: {\n        name: [{ required: true, message: \"角色名称不能为空\", trigger: \"blur\" }]\n      },\n      submitLoading: false,\n      selectList: [],\n      selectCount: 0,\n      columns: [\n        {\n          type: \"selection\",\n          width: 60,\n          align: \"center\"\n        },\n        {\n          type: \"index\",\n          width: 60,\n          align: \"center\"\n        },\n        {\n          title: \"角色名称\",\n          key: \"name\",\n          width: 150,\n          sortable: true\n        },\n        {\n          title: \"备注\",\n          key: \"description\",\n          minWidth: 150,\n          sortable: true\n        },\n        {\n          title: \"创建时间\",\n          key: \"createTime\",\n          width: 170,\n          sortable: true,\n          sortType: \"desc\"\n        },\n        {\n          title: \"更新时间\",\n          key: \"updateTime\",\n          width: 170,\n          sortable: true\n        },\n        {\n          title: \"是否设置为注册用户默认角色\",\n          key: \"defaultRole\",\n          align: \"center\",\n          width: 220,\n          render: (h, params) => {\n            if (params.row.defaultRole) {\n              return h(\"div\", [\n                h(\n                  \"Button\",\n                  {\n                    props: {\n                      type: \"success\",\n                      size: \"small\"\n                    },\n                    style: {\n                      marginRight: \"5px\"\n                    },\n                    on: {\n                      click: () => {\n                        this.cancelDefault(params.row);\n                      }\n                    }\n                  },\n                  \"取消默认\"\n                )\n              ]);\n            } else {\n              return h(\"div\", [\n                h(\n                  \"Button\",\n                  {\n                    props: {\n                      type: \"info\",\n                      size: \"small\"\n                    },\n                    style: {\n                      marginRight: \"5px\"\n                    },\n                    on: {\n                      click: () => {\n                        this.setDefault(params.row);\n                      }\n                    }\n                  },\n                  \"设为默认\"\n                )\n              ]);\n            }\n          }\n        },\n        {\n          title: \"操作\",\n          key: \"action\",\n          align: \"center\",\n          fixed: \"right\",\n          width: 300,\n          render: (h, params) => {\n            return h(\"div\", [\n              h(\n                \"Button\",\n                {\n                  props: {\n                    type: \"warning\",\n                    size: \"small\"\n                  },\n                  style: {\n                    marginRight: \"5px\"\n                  },\n                  on: {\n                    click: () => {\n                      this.editPerm(params.row);\n                    }\n                  }\n                },\n                \"菜单权限\"\n              ),\n              h(\n                \"Button\",\n                {\n                  props: {\n                    type: \"primary\",\n                    size: \"small\"\n                  },\n                  style: {\n                    marginRight: \"5px\"\n                  },\n                  on: {\n                    click: () => {\n                      this.editDep(params.row);\n                    }\n                  }\n                },\n                \"数据权限\"\n              ),\n              h(\n                \"Button\",\n                {\n                  props: {\n                    size: \"small\"\n                  },\n                  style: {\n                    marginRight: \"5px\"\n                  },\n                  on: {\n                    click: () => {\n                      this.edit(params.row);\n                    }\n                  }\n                },\n                \"编辑\"\n              ),\n              h(\n                \"Button\",\n                {\n                  props: {\n                    type: \"error\",\n                    size: \"small\"\n                  },\n                  on: {\n                    click: () => {\n                      this.remove(params.row);\n                    }\n                  }\n                },\n                \"删除\"\n              )\n            ]);\n          }\n        }\n      ],\n      data: [],\n      pageNumber: 1,\n      pageSize: 10,\n      total: 0,\n      permData: [],\n      editRolePermId: \"\",\n      selectAllFlag: false,\n      depData: [],\n      dataType: 0,\n      editDepartments: []\n    };\n  },\n  methods: {\n    init() {\n      this.getRoleList();\n      // 获取所有菜单权限树\n      this.getPermList();\n    },\n    renderContent(h, { root, node, data }) {\n      let icon = \"\";\n      if (data.level == 0) {\n        icon = \"ios-navigate\";\n      } else if (data.level == 1) {\n        icon = \"md-list-box\";\n      } else if (data.level == 2) {\n        icon = \"md-list\";\n      } else if (data.level == 3) {\n        icon = \"md-radio-button-on\";\n      } else {\n        icon = \"md-radio-button-off\";\n      }\n      return h(\n        \"span\",\n        {\n          style: {\n            display: \"inline-block\",\n            cursor: \"pointer\"\n          },\n          on: {\n            click: () => {\n              data.checked = !data.checked;\n            }\n          }\n        },\n        [\n          h(\"span\", [\n            h(\"Icon\", {\n              props: {\n                type: icon,\n                size: \"16\"\n              },\n              style: {\n                \"margin-right\": \"8px\",\n                \"margin-bottom\": \"3px\"\n              }\n            }),\n            h(\"span\", data.title)\n          ])\n        ]\n      );\n    },\n    changePage(v) {\n      this.pageNumber = v;\n      this.getRoleList();\n      this.clearSelectAll();\n    },\n    changePageSize(v) {\n      this.pageSize = v;\n      this.getRoleList();\n    },\n    changeSort(e) {\n      this.sortColumn = e.key;\n      this.sortType = e.order;\n      if (e.order == \"normal\") {\n        this.sortType = \"\";\n      }\n      this.getRoleList();\n    },\n    getRoleList() {\n      this.loading = true;\n      let params = {\n        pageNumber: this.pageNumber,\n        pageSize: this.pageSize,\n        sort: this.sortColumn,\n        order: this.sort\n      };\n      getRoleList(params).then(res => {\n        this.loading = false;\n        if (res.success) {\n          this.data = res.result.content;\n          this.total = res.result.totalElements;\n        }\n      });\n    },\n    getPermList() {\n      this.treeLoading = true;\n      getAllPermissionList().then(res => {\n        if (res.success) {\n          this.deleteDisableNode(res.result);\n          this.permData = res.result;\n          this.treeLoading = false;\n        }\n        this.treeLoading = false;\n      });\n    },\n    // 递归标记禁用节点\n    deleteDisableNode(permData) {\n      let that = this;\n      permData.forEach(function(e) {\n        if (e.status == -1) {\n          e.title = \"[已禁用] \" + e.title;\n          e.disabled = true;\n        }\n        if (e.children && e.children.length > 0) {\n          that.deleteDisableNode(e.children);\n        }\n      });\n    },\n    cancelRole() {\n      this.roleModalVisible = false;\n    },\n    submitRole() {\n      this.$refs.roleForm.validate(valid => {\n        if (valid) {\n          if (this.modalType == 0) {\n            // 添加\n            this.submitLoading = true;\n            addRole(this.roleForm).then(res => {\n              this.submitLoading = false;\n              if (res.success) {\n                this.$Message.success(\"操作成功\");\n                this.getRoleList();\n                this.roleModalVisible = false;\n              }\n            });\n          } else {\n            this.submitLoading = true;\n            editRole(this.roleForm).then(res => {\n              this.submitLoading = false;\n              if (res.success) {\n                this.$Message.success(\"操作成功\");\n                this.getRoleList();\n                this.roleModalVisible = false;\n              }\n            });\n          }\n        }\n      });\n    },\n    addRole() {\n      this.modalType = 0;\n      this.modalTitle = \"添加角色\";\n      this.$refs.roleForm.resetFields();\n      delete this.roleForm.id;\n      this.roleModalVisible = true;\n    },\n    edit(v) {\n      this.modalType = 1;\n      this.modalTitle = \"编辑角色\";\n      this.$refs.roleForm.resetFields();\n      // 转换null为\"\"\n      for (let attr in v) {\n        if (v[attr] == null) {\n          v[attr] = \"\";\n        }\n      }\n      let str = JSON.stringify(v);\n      let roleInfo = JSON.parse(str);\n      this.roleForm = roleInfo;\n      this.roleModalVisible = true;\n    },\n    remove(v) {\n      this.$Modal.confirm({\n        title: \"确认删除\",\n        content: \"您确认要删除角色 \" + v.name + \" ?\",\n        loading: true,\n        onOk: () => {\n          deleteRole({ids: v.id}).then(res => {\n            this.$Modal.remove();\n            if (res.success) {\n              this.$Message.success(\"删除成功\");\n              this.getRoleList();\n            }\n          });\n        }\n      });\n    },\n    setDefault(v) {\n      this.$Modal.confirm({\n        title: \"确认设置\",\n        content: \"您确认要设置所选的 \" + v.name + \" 为注册用户默认角色?\",\n        loading: true,\n        onOk: () => {\n          let params = {\n            id: v.id,\n            isDefault: true\n          };\n          setDefaultRole(params).then(res => {\n            this.$Modal.remove();\n            if (res.success) {\n              this.$Message.success(\"操作成功\");\n              this.getRoleList();\n            }\n          });\n        }\n      });\n    },\n    cancelDefault(v) {\n      this.$Modal.confirm({\n        title: \"确认取消\",\n        content: \"您确认要取消所选的 \" + v.name + \" 角色为默认?\",\n        loading: true,\n        onOk: () => {\n          let params = {\n            id: v.id,\n            isDefault: false\n          };\n          setDefaultRole(params).then(res => {\n            this.$Modal.remove();\n            if (res.success) {\n              this.$Message.success(\"操作成功\");\n              this.getRoleList();\n            }\n          });\n        }\n      });\n    },\n    clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n    changeSelect(e) {\n      this.selectList = e;\n      this.selectCount = e.length;\n    },\n    delAll() {\n      if (this.selectCount <= 0) {\n        this.$Message.warning(\"您还未选择要删除的数据\");\n        return;\n      }\n      this.$Modal.confirm({\n        title: \"确认删除\",\n        content: \"您确认要删除所选的 \" + this.selectCount + \" 条数据?\",\n        loading: true,\n        onOk: () => {\n          let ids = \"\";\n          this.selectList.forEach(function(e) {\n            ids += e.id + \",\";\n          });\n          ids = ids.substring(0, ids.length - 1);\n          deleteRole({ids: ids}).then(res => {\n            this.$Modal.remove();\n            if (res.success) {\n              this.$Message.success(\"删除成功\");\n              this.clearSelectAll();\n              this.getRoleList();\n            }\n          });\n        }\n      });\n    },\n    editPerm(v) {\n      this.editRolePermId = v.id;\n      this.modalTitle = \"分配 \" + v.name + \" 的菜单权限\";\n      // 匹配勾选\n      let rolePerms = v.permissions;\n      if (this.treeLoading) {\n        this.$Message.warning(\"菜单权限数据加载中，请稍后点击查看\");\n        return;\n      }\n      // 递归判断子节点\n      this.checkPermTree(this.permData, rolePerms);\n      this.permModalVisible = true;\n    },\n    // 递归判断子节点\n    checkPermTree(permData, rolePerms) {\n      let that = this;\n      permData.forEach(function(p) {\n        if (that.hasPerm(p, rolePerms) && p.status != -1) {\n          p.checked = true;\n        } else {\n          p.checked = false;\n        }\n        if (p.children && p.children.length > 0) {\n          that.checkPermTree(p.children, rolePerms);\n        }\n      });\n    },\n    // 判断角色拥有的权限节点勾选\n    hasPerm(p, rolePerms) {\n      let flag = false;\n      for (let i = 0; i < rolePerms.length; i++) {\n        if (p.id == rolePerms[i].permissionId) {\n          flag = true;\n          break;\n        }\n      }\n      if (flag) {\n        return true;\n      }\n      return false;\n    },\n    // 全选反选\n    selectTreeAll() {\n      this.selectAllFlag = !this.selectAllFlag;\n      let select = this.selectAllFlag;\n      this.selectedTreeAll(this.permData, select);\n    },\n    // 递归全选节点\n    selectedTreeAll(permData, select) {\n      let that = this;\n      permData.forEach(function(e) {\n        e.checked = select;\n        if (e.children && e.children.length > 0) {\n          that.selectedTreeAll(e.children, select);\n        }\n      });\n    },\n    submitPermEdit() {\n      this.submitPermLoading = true;\n      let permIds = \"\";\n      let selectedNodes = this.$refs.tree.getCheckedNodes();\n      selectedNodes.forEach(function(e) {\n        permIds += e.id + \",\";\n      });\n      permIds = permIds.substring(0, permIds.length - 1);\n      editRolePerm({\n        roleId: this.editRolePermId,\n        permIds: permIds\n      }).then(res => {\n        this.submitPermLoading = false;\n        if (res.success) {\n          this.$Message.success(\"操作成功\");\n          // 标记重新获取菜单数据\n          this.$store.commit(\"setAdded\", false);\n          util.initRouter(this);\n          this.getRoleList();\n          this.permModalVisible = false;\n        }\n      });\n    },\n    cancelPermEdit() {\n      this.permModalVisible = false;\n    },\n    loadData(item, callback) {\n      loadDepartment(item.id, { openDataFilter: false }).then(res => {\n        if (res.success) {\n          res.result.forEach(function(e) {\n            e.selected = false;\n            if (e.isParent) {\n              e.loading = false;\n              e.children = [];\n            }\n            if (e.status == -1) {\n              e.title = \"[已禁用] \" + e.title;\n              e.disabled = true;\n            }\n          });\n          callback(res.result);\n        }\n      });\n    },\n    editDep(v) {\n      this.dataType = 0;\n      this.editRolePermId = v.id;\n      this.modalTitle = \"分配 \" + v.name + \" 的数据权限\";\n      if (v.dataType) {\n        this.dataType = v.dataType;\n      }\n      // 匹配勾选\n      let roleDepIds = v.departments;\n      this.editDepartments = roleDepIds;\n      this.depTreeLoading = true;\n      initDepartment({ openDataFilter: false }).then(res => {\n        this.depTreeLoading = false;\n        if (res.success) {\n          res.result.forEach(function(e) {\n            e.selected = false;\n            if (e.isParent) {\n              e.loading = false;\n              e.children = [];\n            }\n            if (e.status == -1) {\n              e.title = \"[已禁用] \" + e.title;\n              e.disabled = true;\n            }\n          });\n          this.depData = res.result;\n          // 判断子节点\n          this.checkDepTree(this.depData, roleDepIds);\n        }\n      });\n      this.depModalVisible = true;\n    },\n    expandCheckDep(v) {\n      // 判断展开子节点\n      this.checkDepTree(v.children, this.editDepartments);\n    },\n    // 判断子节点\n    checkDepTree(depData, roleDepIds) {\n      let that = this;\n      depData.forEach(function(p) {\n        if (that.hasDepPerm(p, roleDepIds)) {\n          p.selected = true;\n        } else {\n          p.selected = false;\n        }\n      });\n    },\n    // 判断角色拥有的权限节点勾选\n    hasDepPerm(p, roleDepIds) {\n      let flag = false;\n      for (let i = 0; i < roleDepIds.length; i++) {\n        if (p.id == roleDepIds[i].departmentId) {\n          flag = true;\n          break;\n        }\n      }\n      if (flag) {\n        return true;\n      }\n      return false;\n    },\n    submitDepEdit() {\n      let depIds = \"\";\n      if (this.dataType == 1) {\n        let selectedNodes = this.$refs.depTree.getSelectedNodes();\n        selectedNodes.forEach(function(e) {\n          depIds += e.id + \",\";\n        });\n        depIds = depIds.substring(0, depIds.length - 1);\n      }\n      this.submitDepLoading = true;\n      editRoleDep({\n        roleId: this.editRolePermId,\n        dataType: this.dataType,\n        depIds: depIds\n      }).then(res => {\n        this.submitDepLoading = false;\n        if (res.success) {\n          this.$Message.success(\"操作成功\");\n          this.getRoleList();\n          this.depModalVisible = false;\n        }\n      });\n    },\n    changeOpen(v) {\n      if (v == \"0\") {\n        this.permData.forEach(e => {\n          e.expand = true;\n          if (e.children && e.children.length > 0) {\n            e.children.forEach(c => {\n              c.expand = true;\n              if (c.children && c.children.length > 0) {\n                c.children.forEach(function(b) {\n                  b.expand = true;\n                });\n              }\n            });\n          }\n        });\n      } else if (v == \"1\") {\n        this.permData.forEach(e => {\n          e.expand = false;\n          if (e.children && e.children.length > 0) {\n            e.children.forEach(c => {\n              c.expand = false;\n              if (c.children && c.children.length > 0) {\n                c.children.forEach(function(b) {\n                  b.expand = false;\n                });\n              }\n            });\n          }\n        });\n      } else if (v == \"2\") {\n        this.permData.forEach(e => {\n          e.expand = true;\n          if (e.children && e.children.length > 0) {\n            e.children.forEach(c => {\n              c.expand = false;\n              if (c.children && c.children.length > 0) {\n                c.children.forEach(function(b) {\n                  b.expand = false;\n                });\n              }\n            });\n          }\n        });\n      } else if (v == \"3\") {\n        this.permData.forEach(e => {\n          e.expand = true;\n          if (e.children && e.children.length > 0) {\n            e.children.forEach(c => {\n              c.expand = true;\n              if (c.children && c.children.length > 0) {\n                c.children.forEach(function(b) {\n                  b.expand = false;\n                });\n              }\n            });\n          }\n        });\n      }\n    }\n  },\n  mounted() {\n    this.init();\n  }\n};\n</script>"]}]}