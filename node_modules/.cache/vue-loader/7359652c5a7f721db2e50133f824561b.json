{"remainingRequest":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\dove\\project\\xboot\\xboot-front-master\\src\\views\\my-components\\xboot\\department-tree-choose.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\src\\views\\my-components\\xboot\\department-tree-choose.vue","mtime":1600218271000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dove\\project\\xboot\\xboot-front-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGluaXREZXBhcnRtZW50LCBsb2FkRGVwYXJ0bWVudCwgc2VhcmNoRGVwYXJ0bWVudCB9IGZyb20gIkAvYXBpL2luZGV4IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJkZXBhcnRtZW50VHJlZUNob29zZSIsCiAgcHJvcHM6IHsKICAgIG11bHRpcGxlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgY2xlYXJhYmxlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCiAgICBwbGFjZWhvbGRlcjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICLngrnlh7vpgInmi6npg6jpl6giCiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGVwTG9hZGluZzogZmFsc2UsCiAgICAgIGRlcGFydG1lbnRUaXRsZTogIiIsCiAgICAgIHNlYXJjaEtleTogIiIsCiAgICAgIGRhdGFEZXA6IFtdLAogICAgICBzZWxlY3REZXA6IFtdLAogICAgICBkZXBhcnRtZW50SWQ6IFtdCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgaW5pdERlcGFydG1lbnREYXRhKCkgewogICAgICBpbml0RGVwYXJ0bWVudCgpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHJlcy5yZXN1bHQuZm9yRWFjaChmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIGlmIChlLmlzUGFyZW50KSB7CiAgICAgICAgICAgICAgZS5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgZS5jaGlsZHJlbiA9IFtdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChlLnN0YXR1cyA9PSAtMSkgewogICAgICAgICAgICAgIGUudGl0bGUgPSAiW+W3suemgeeUqF0gIiArIGUudGl0bGU7CiAgICAgICAgICAgICAgZS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kYXRhRGVwID0gcmVzLnJlc3VsdDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGxvYWREYXRhKGl0ZW0sIGNhbGxiYWNrKSB7CiAgICAgIGxvYWREZXBhcnRtZW50KGl0ZW0uaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHJlcy5yZXN1bHQuZm9yRWFjaChmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIGlmIChlLmlzUGFyZW50KSB7CiAgICAgICAgICAgICAgZS5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgZS5jaGlsZHJlbiA9IFtdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChlLnN0YXR1cyA9PSAtMSkgewogICAgICAgICAgICAgIGUudGl0bGUgPSAiW+W3suemgeeUqF0gIiArIGUudGl0bGU7CiAgICAgICAgICAgICAgZS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgY2FsbGJhY2socmVzLnJlc3VsdCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBzZWFyY2hEZXAoKSB7CiAgICAgIC8vIOaQnOe0oumDqOmXqAogICAgICBpZiAodGhpcy5zZWFyY2hLZXkpIHsKICAgICAgICB0aGlzLmRlcExvYWRpbmcgPSB0cnVlOwogICAgICAgIHNlYXJjaERlcGFydG1lbnQoeyB0aXRsZTogdGhpcy5zZWFyY2hLZXkgfSkudGhlbihyZXMgPT4gewogICAgICAgICAgdGhpcy5kZXBMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgcmVzLnJlc3VsdC5mb3JFYWNoKGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICBpZiAoZS5zdGF0dXMgPT0gLTEpIHsKICAgICAgICAgICAgICAgIGUudGl0bGUgPSAiW+W3suemgeeUqF0gIiArIGUudGl0bGU7CiAgICAgICAgICAgICAgICBlLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLmRhdGFEZXAgPSByZXMucmVzdWx0OwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW5pdERlcGFydG1lbnREYXRhKCk7CiAgICAgIH0KICAgIH0sCiAgICBzZWxlY3RUcmVlKHYpIHsKICAgICAgbGV0IGlkcyA9IFtdLAogICAgICAgIHRpdGxlID0gIiI7CiAgICAgIHYuZm9yRWFjaChlID0+IHsKICAgICAgICBpZHMucHVzaChlLmlkKTsKICAgICAgICBpZiAodGl0bGUgPT0gIiIpIHsKICAgICAgICAgIHRpdGxlID0gZS50aXRsZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGl0bGUgPSB0aXRsZSArICLjgIEiICsgZS50aXRsZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLmRlcGFydG1lbnRJZCA9IGlkczsKICAgICAgdGhpcy5kZXBhcnRtZW50VGl0bGUgPSB0aXRsZTsKICAgICAgaWYgKHRoaXMubXVsdGlwbGUpIHsKICAgICAgICB0aGlzLiRlbWl0KCJvbi1jaGFuZ2UiLCB0aGlzLmRlcGFydG1lbnRJZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kZW1pdCgib24tY2hhbmdlIiwgdGhpcy5kZXBhcnRtZW50SWRbMF0pOwogICAgICB9CiAgICB9LAogICAgY2xlYXJTZWxlY3QoKSB7CiAgICAgIHRoaXMuZGVwYXJ0bWVudElkID0gW107CiAgICAgIHRoaXMuZGVwYXJ0bWVudFRpdGxlID0gIiI7CiAgICAgIHRoaXMuaW5pdERlcGFydG1lbnREYXRhKCk7CiAgICAgIGlmICh0aGlzLm11bHRpcGxlKSB7CiAgICAgICAgdGhpcy4kZW1pdCgib24tY2hhbmdlIiwgW10pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJGVtaXQoIm9uLWNoYW5nZSIsICIiKTsKICAgICAgfQogICAgICB0aGlzLiRlbWl0KCJvbi1jbGVhciIpOwogICAgfSwKICAgIHNldERhdGEoaWRzLCB0aXRsZSkgewogICAgICB0aGlzLmRlcGFydG1lbnRUaXRsZSA9IHRpdGxlOwogICAgICBpZiAodGhpcy5tdWx0aXBsZSkgewogICAgICAgIHRoaXMuZGVwYXJ0bWVudElkID0gaWRzOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZGVwYXJ0bWVudElkID0gW107CiAgICAgICAgdGhpcy5kZXBhcnRtZW50SWQucHVzaChpZHMpOwogICAgICB9CiAgICAgIHRoaXMuJGVtaXQoIm9uLWNoYW5nZSIsIHRoaXMuZGVwYXJ0bWVudElkKTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmluaXREZXBhcnRtZW50RGF0YSgpOwogIH0KfTsK"},{"version":3,"sources":["department-tree-choose.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"department-tree-choose.vue","sourceRoot":"src/views/my-components/xboot","sourcesContent":["<template>\n  <div>\n    <div style=\"display:flex;\">\n      <Input\n        v-model=\"departmentTitle\"\n        readonly\n        style=\"margin-right:10px;\"\n        :placeholder=\"placeholder\"\n        :clearable=\"clearable\"\n        @on-clear=\"clearSelect\"\n      />\n      <Poptip transfer trigger=\"click\" placement=\"right\" title=\"选择部门\" width=\"250\">\n        <Button icon=\"md-list\">选择部门</Button>\n        <div slot=\"content\">\n          <Input\n            v-model=\"searchKey\"\n            suffix=\"ios-search\"\n            @on-change=\"searchDep\"\n            placeholder=\"输入部门名搜索\"\n            clearable\n          />\n          <div class=\"dep-tree-bar\">\n            <Tree\n              :data=\"dataDep\"\n              :load-data=\"loadData\"\n              @on-select-change=\"selectTree\"\n              :multiple=\"multiple\"\n            ></Tree>\n            <Spin size=\"large\" fix v-if=\"depLoading\"></Spin>\n          </div>\n        </div>\n      </Poptip>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { initDepartment, loadDepartment, searchDepartment } from \"@/api/index\";\nexport default {\n  name: \"departmentTreeChoose\",\n  props: {\n    multiple: {\n      type: Boolean,\n      default: false\n    },\n    clearable: {\n      type: Boolean,\n      default: true\n    },\n    placeholder: {\n      type: String,\n      default: \"点击选择部门\"\n    }\n  },\n  data() {\n    return {\n      depLoading: false,\n      departmentTitle: \"\",\n      searchKey: \"\",\n      dataDep: [],\n      selectDep: [],\n      departmentId: []\n    };\n  },\n  methods: {\n    initDepartmentData() {\n      initDepartment().then(res => {\n        if (res.success) {\n          res.result.forEach(function(e) {\n            if (e.isParent) {\n              e.loading = false;\n              e.children = [];\n            }\n            if (e.status == -1) {\n              e.title = \"[已禁用] \" + e.title;\n              e.disabled = true;\n            }\n          });\n          this.dataDep = res.result;\n        }\n      });\n    },\n    loadData(item, callback) {\n      loadDepartment(item.id).then(res => {\n        if (res.success) {\n          res.result.forEach(function(e) {\n            if (e.isParent) {\n              e.loading = false;\n              e.children = [];\n            }\n            if (e.status == -1) {\n              e.title = \"[已禁用] \" + e.title;\n              e.disabled = true;\n            }\n          });\n          callback(res.result);\n        }\n      });\n    },\n    searchDep() {\n      // 搜索部门\n      if (this.searchKey) {\n        this.depLoading = true;\n        searchDepartment({ title: this.searchKey }).then(res => {\n          this.depLoading = false;\n          if (res.success) {\n            res.result.forEach(function(e) {\n              if (e.status == -1) {\n                e.title = \"[已禁用] \" + e.title;\n                e.disabled = true;\n              }\n            });\n            this.dataDep = res.result;\n          }\n        });\n      } else {\n        this.initDepartmentData();\n      }\n    },\n    selectTree(v) {\n      let ids = [],\n        title = \"\";\n      v.forEach(e => {\n        ids.push(e.id);\n        if (title == \"\") {\n          title = e.title;\n        } else {\n          title = title + \"、\" + e.title;\n        }\n      });\n      this.departmentId = ids;\n      this.departmentTitle = title;\n      if (this.multiple) {\n        this.$emit(\"on-change\", this.departmentId);\n      } else {\n        this.$emit(\"on-change\", this.departmentId[0]);\n      }\n    },\n    clearSelect() {\n      this.departmentId = [];\n      this.departmentTitle = \"\";\n      this.initDepartmentData();\n      if (this.multiple) {\n        this.$emit(\"on-change\", []);\n      } else {\n        this.$emit(\"on-change\", \"\");\n      }\n      this.$emit(\"on-clear\");\n    },\n    setData(ids, title) {\n      this.departmentTitle = title;\n      if (this.multiple) {\n        this.departmentId = ids;\n      } else {\n        this.departmentId = [];\n        this.departmentId.push(ids);\n      }\n      this.$emit(\"on-change\", this.departmentId);\n    }\n  },\n  created() {\n    this.initDepartmentData();\n  }\n};\n</script>\n\n<style lang=\"less\">\n.dep-tree-bar {\n  position: relative;\n  min-height: 80px;\n  max-height: 500px;\n  overflow: auto;\n  margin-top: 5px;\n}\n\n.dep-tree-bar::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n}\n\n.dep-tree-bar::-webkit-scrollbar-thumb {\n  border-radius: 4px;\n  -webkit-box-shadow: inset 0 0 2px #d1d1d1;\n  background: #e4e4e4;\n}\n</style>\n\n"]}]}